<html>
    <head>
        <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-motion-capture-components/dist/aframe-motion-capture-components.min.js"></script>
        <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v3.9.0/dist/aframe-extras.min.js"></script>
        <script src="https://unpkg.com/super-hands@1.0.1/dist/super-hands.min.js"></script>
        <script src="https://unpkg.com/aframe-cubemap-component@0.1.2/dist/aframe-cubemap-component.min.js"></script>
        <script src="https://etiennepinchon.github.io/aframe-rounded/lib/rounded.js"></script>
        <!-- Custom Javascript Components -->
        <script src="components/utils.js"></script>
        <script src="components/alert.js"></script>
        <script src="components/avatar.js"></script>
        <script src="components/bones.js"></script>
        <script src="components/cursorscale.js"></script>
        <script src="components/curvedvideo.js"></script>
        <script src="components/getcontrollerpos.js"></script>
        <script src="components/gridmenu.js"></script>
        <script src="components/imagealert.js"></script>
        <script src="components/manycube.js"></script>
        <script src="components/menuable.js"></script>
        <script src="components/objectmenu.js"></script>
        <script src="components/notification.js"></script>
        <script src="components/stacker.js"></script>
    </head>
    <body>
        <a-scene avatar-recorder>
            <a-assets>
                <img id="boxTexture" src="https://i.imgur.com/mYmmbrp.jpg" crossorigin="true"/>
                <img id="skyTexture" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/sechelt.jpg" crossorigin="true"/>
                <img id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg" crossorigin="true"/>
                <img id="ejbluemat" src="https://ucarecdn.com/e8271956-254d-4bd5-85a4-02ba6d21578b/" crossorigin="true"/>
                <img id="imagestretch" src="https://ucarecdn.com/0e1a6433-4961-47d9-99ea-d90230bcf3e6/" crossorigin="true"/>
                <img id="iconcl" src="https://ucarecdn.com/dfa1bdf4-c47b-4287-a8e6-dbdaac79e13e/" crossorigin="true"></a-asset-item>
                <!--<video id="xvr" autoplay loop="true" src="https://ucarecdn.com/40817a04-ea96-415e-8cf4-cca1b144711f/" crossorigin="true"></video>
                <video id="paris" autoplay loop="true" src="https://ucarecdn.com/4130c599-445f-4e76-9052-49978e972641/" crossorigin="true"></video>-->
                <!--<video id="xvr" autoplay loop="true" src="https://ucarecdn.com/fadab25d-0b3a-45f7-8ef5-85318e92a261/" crossorigin="true"></video>-->
                <!--<video id="xvr" autoplay loop="true" src="https://ucarecdn.com/4130c599-445f-4e76-9052-49978e972641/" crossorigin="true"></video>-->
                <!--<audio id="spatialaudio"src="https://cdn.aframe.io/basic-guide/audio/backgroundnoise.wav"></audio>-->
                <audio id="spatialaudio" src="https://ucarecdn.com/53fd1dd9-0813-46ef-b02c-4e9e4638053f/" preload crossorigin="true"></audio>
                <!--<a-asset-item id="firstchair" src="https://ucarecdn.com/86a52a70-f451-4e0b-afdc-7dc5915577a9/" crossorigin="true"></a-asset-item>-->
                <a-asset-item id="firstchairobj" src="https://ucarecdn.com/9d5845c1-e5ba-4ca1-878f-0920b1238846/" crossorigin="true"></a-asset-item>
                <!--<a-asset-item id="arpitavatar" src="https://ucarecdn.com/e980bad3-2dc4-4ad0-81fc-73726c5e3b5a/" crossorigin="true"></a-asset-item>
                <a-asset-item id="arpitcollada" src="https://ucarecdn.com/8265dce7-cb66-4804-a59f-fbf5b84fb0d3/" crossorigin="true"></a-asset-item>-->
                <a-asset-item id="arpitjson" src="https://ucarecdn.com/765fd642-61ed-4bac-a13a-dc1b21429b67/" crossorigin="true"></a-asset-item>
                <!-- Old Blue Model <a-asset-item id="arpitjson" src="https://ucarecdn.com/b229522f-bde3-49d4-bd0f-5b6313bb593f/" crossorigin="true"></a-asset-item> -->
                <!-- <a-asset-item id="firstchairobj" src="https://ucarecdn.com/66de89a6-8747-4bff-9993-5e2977a79445/" crossorigin="true"></a-asset-item> -->
            </a-assets>
            <a-box id="redbox" src="#boxTexture" color="red" position="5 2 -4" rotation="0 45 45" scale="2 2 2" cursor-scale menuable>
                <!-- These animations are now added with the cursor-scale custom component I wrote!
                <a-animation attribute="scale" begin="mouseenter" dur="300" to="2.3 2.3 2.3"></a-animation>
                <a-animation attribute="scale" begin="mouseleave" dur="300" to="2 2 2"></a-animation>
                <a-animation attribute="rotation" begin="click" dur="2000" to="360 405 45"></a-animation> -->
            </a-box>
            <a-sky src="#skyTexture"></a-sky>
            <a-plane src="#groundTexture" height="30" width="30" rotation="-90 0 0" repeat="10 10"></a-plane>
            <a-light type="ambient" color="#445451"></a-light>
            <a-light type="point" intensity="2" position="2 4 4"></a-light>
            <!--<a-sound src="#spatialaudio" autoplay="true" position="0 0 0"></a-sound>-->
            <a-text value="Click Me!" color="#BBB" position="4 0.2 -4" scale="1.5 1.5 1.5" rotation="0 -40 0"></a-text>

            <!-- Super hands does not work on custom models. Need to wrap custom models with other components to have them move! -->
            <a-box id="bluechair" position="-1.5 .25 .5" rotation="0 -90 0" alpha="0" material="opacity:0" grabbable stretchable menuable>
                <a-entity obj-model="obj: #firstchairobj;" material="src:#ejbluemat;" scale=".25 .25 .25"></a-entity>
            </a-box>

            <a-entity id="many-cube" many-cube position= ".5 1.5 .5" grabbable stretchable menuable></a-entity>

            <a-entity id="maincamera" position="0 0 0">
                <a-camera>
                    <a-cursor id="maincursor" color="yellow"></a-cursor>
                </a-camera>
            </a-entity>
            <a-entity id="controller1" hand-controls="left" super-hands sphere-collider="objects: a-entity, a-box, a-image, a-video, a-curvedimage, a-text"></a-entity>
            <a-entity id="controller2" hand-controls="right" super-hands sphere-collider="objects: a-entity, a-box, a-image, a-video, a-curvedimage, a-text"></a-entity>
            <a-entity id="playeravatar" bones json-model="src: #arpitjson;" position="-1.5 .5 .5"></a-entity>
            <a-link href="https://aframe.io/aframe/examples/showcase/link-traversal/city.html" title="Warp to a New World!" image="#skyTexture" position="0 1 2" scale=".5 .5 .5" highlightedColor="#222222"></a-link>
            <!--<a-image src="#imagestretch" position="0 1 -0" stretchable grabbable></a-image>-->
            <a-entity image-alert="bgcolor:black; text:Welcome to Comcast's Web VR Experience!; textcolor:white;" position="0 2 -2" scale=".25 .25 .25"></a-entity>
        </a-scene>
        <script type="text/javascript">
            //Bad way of handling events - use custom components see cursor-scale component example above scene!
            var myBox = document.querySelector('#many-cube');
            var controller1 = document.querySelector("#controller1");
            var scene = document.querySelector("a-scene");

            scene.addEventListener('loaded', function () {
                //Get axis values from controller1
                controller1.addEventListener("axismove", function(e){
                    console.log("x = " + e.detail.axis[0]);
                    console.log("y = " + e.detail.axis[1]);
                    mybone.position.x = e.detail.axis[0];
                    mybone.position.y = e.detail.axis[1];
                });

                //detect thumbstick press
                controller1.addEventListener("thumbstickdown", function(e){
                    console.log(e);
                    myBox.setAttribute("scale", {x: 1, y:1, z:1});
                    console.log(controller1.object3D.position);
                });

                //detect bottom grip press and scale custom box down
                controller1.addEventListener("gripdown", function(e){
                    console.log(e);
                    myBox.setAttribute("scale", {x:1, y:1, z:1});
                });

                var count = 0;
                document.addEventListener("keypress", function(e){
                    console.log(e);
                    if(e.charCode == 112){
                        count++;
                        if(count % 2 == 0){
                            onStopMocap();
                        } else {
                            onPlayMocap();
                        }
                    }
                });
            });

            function onPlayMocap(){
                scene.setAttribute("avatar-replayer", "");
                console.log("Playing Mocap");
                console.log(scene);
            }

            function onStopMocap(){
                scene.removeAttribute("avatar-replayer");
                console.log("Stopping Mocap");
                console.log(scene);
            }
        </script>
    </body>
</html>
